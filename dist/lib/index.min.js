"use strict";var _store=require("svelte/store");function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}function _objectWithoutProperties(t,e){if(null==t)return{};var i,s,n=_objectWithoutPropertiesLoose(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(s=0;s<r.length;s++)i=r[s],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function _objectWithoutPropertiesLoose(t,e){if(null==t)return{};var i,s,n={},r=Object.keys(t);for(s=0;s<r.length;s++)i=r[s],e.indexOf(i)>=0||(n[i]=t[i]);return n}var Writable=function(t){var e=(0,_store.writable)(t),i=e.subscribe,s=_objectWithoutProperties(e,["subscribe"]);return Object.assign({subscribe:i},s,{get:function(){var t;return i((function(e){t=e}))(),t}})},SideBarSwipe=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=i.sideOpacity,n=void 0===s?.2:s,r=i.transitionDuration,o=void 0===r?300:r,h=i.maxScreenWidth,a=void 0===h?768:h,l=i.transitionTimingFunc,c=void 0===l?"cubic-bezier(0.9, 0.28, 0.08, 1.13)":l;_classCallCheck(this,t);var p=Array.from(document.querySelectorAll("sidebar-swipe")).filter((function(t){return t.shadowRoot&&t.shadowRoot.querySelector(e)}));this.swipe=p.length>0?p[0].shadowRoot.firstElementChild:document.querySelector(e),this.swipe.style.display="none",this.duration=o,this.timingFn=c,this.screenWidth=a,this.endTranslate=0,this.beforeEndTranslate=0,this.opened=Writable(!0),this.prevcx=0,this.opacity=n,this.initStart(),this.initEvents()}return _createClass(t,[{key:"_navtransition_",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.swipe.firstElementChild.style.transition=t?"transform ".concat(this.duration,"ms ").concat(this.timingFn):""}},{key:"initStart",value:function(){var t=this;this.applied?(this.swipe.style.width="100%",this.swipe.style.position="fixed",this.swipe.style.overflowY="overlay",this.swipe.style.height="100%",this.swipe.firstElementChild.style.minHeight="100%",this.swipe.style.transition="background .5s ease",this.swipe.style.background="rgba(0,0,0,0)",this.swipe.style.display="none",this.swipe.firstElementChild.style.width=this.width,this.swipe.addEventListener("click",(function(e){e.target===e.currentTarget&&t.close()})),this._navtransition_(),this.endTranslate=(this.right?1:-1)*document.body.offsetWidth,this.opened.set(!1),this.setTransform(),this.wasApplied||this.swipe.addEventListener("click",(function(e){e.target===e.currentTarget&&t.close()})),this.wasApplied=!0):(this.swipe.style.position="",this.swipe.style.overflowY="",this.swipe.style.height="",this.swipe.firstElementChild.style.minHeight="",this.swipe.style.transition="",this.swipe.style.width="",this.swipe.style.background="",this.swipe.style.display="",this.swipe.style.justifyContent="",this.swipe.firstElementChild.style.width="",this._navtransition_(!1),this.swipe.firstElementChild.style.transform="",this.initEvents(!0),this.wasApplied||this.swipe.removeEventListener("click",(function(e){e.target===e.currentTarget&&t.close()})),this.wasApplied=!1)}},{key:"initEvents",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.swipe[e?"removeEventListener":"addEventListener"]("touchstart",(function(e){return t.startFn(e)}),!1),this.swipe[e?"removeEventListener":"addEventListener"]("touchmove",(function(e){return t.moveFn(e)}),!1),this.swipe[e?"removeEventListener":"addEventListener"]("touchend",(function(e){return t.endFn(e)}),!1),this.swipe[e?"removeEventListener":"addEventListener"]("touchcancel",(function(t){return console.log(t)}),!1)}},{key:"startFn",value:function(t){this.applied&&(this.prevcx=t.touches[0].clientX,this.touchType="start")}},{key:"moveFn",value:function(t){if(t.preventDefault(),this.applied){this._navtransition_(!1);var e=t.touches[0].clientX,i=this.endTranslate+e-this.prevcx;e>2&&(i<0&&!this.right||i>0&&this.right)&&(this.endTranslate=i,this.beforeEndTranslate=Math.abs(i),this.setTransform(),this.prevcx=e,this.touchType="move")}}},{key:"endFn",value:function(t){this.applied&&"move"===this.touchType&&(this._navtransition_(),this.beforeEndTranslate/this.swipe.offsetWidth*100>40?this.close():this.open(),this.touchType="end")}},{key:"setTransform",value:function(){if(this.applied){this.swipe.firstElementChild.style.transform="translate(".concat(this.endTranslate+"px",")");var t=this.opacity-this.beforeEndTranslate/this.swipe.firstElementChild.offsetWidth*this.opacity;this.swipe.style.background="rgba(0,0,0,".concat(t,")")}}},{key:"open",value:function(){var t=this;this.applied&&(this.swipe.style.display="block",this.swipe.firstElementChild.style.float=this.right?"right":"left",this.swipe.firstElementChild.classList.add("sb-opened"),setTimeout((function(){t.endTranslate=0,t.opened.set(!0),t.setTransform(),t.swipe.style.background="rgba(0,0,0,".concat(t.opacity,")")}),.8))}},{key:"close",value:function(){var t=this;if(this.applied){var e=(this.right?1:-1)*this.swipe.offsetWidth;this.endTranslate=e,this.opened.set(!1),this.setTransform(),this.swipe.style.background="rgba(0,0,0,0)",setTimeout((function(){t.swipe.style.display="none",t.swipe.firstElementChild.classList.remove("sb-opened")}),this.duration)}}},{key:"toggle",value:function(){this.opened.get()?this.close():this.open()}},{key:"right",get:function(){return this.swipe.hasAttribute("right")&&!("false"===this.swipe.getAttribute("right")||!1===this.swipe.getAttribute("right"))},set:function(t){this.swipe.setAttribute("right",t),this.initStart()}},{key:"width",get:function(){var t=this.swipe.firstElementChild.getAttribute("width");return t?/^[0-9]+$/.test("".concat(t))?t+"%":t:"80%"}},{key:"applied",get:function(){return window.innerWidth<=this.screenWidth}}]),t}();
