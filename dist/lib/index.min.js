"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function _createClass(t,i,e){return i&&_defineProperties(t.prototype,i),e&&_defineProperties(t,e),t}var SideBarSwipe=function(){function t(i){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=e.sideOpacity,n=void 0===s?.2:s,r=e.transitionDuration,h=void 0===r?300:r,o=e.maxScreenWidth,a=void 0===o?768:o,d=e.transitionTimingFunc,l=void 0===d?"ease":d;_classCallCheck(this,t);var c=Array.from(document.querySelectorAll("sidebar-swipe")).filter((function(t){return t.shadowRoot&&t.shadowRoot.querySelector(i)}));this.swipe=c?c[0].shadowRoot.firstElementChild:document.querySelector(i),this.swipe.style.display="none",this.duration=h,this.timingFn=l,this.screenWidth=a,this.endTranslate=0,this.beforeEndTranslate=0,this.opened=!0,this.prevcx=0,this.opacity=n,this.initStart(),this.initEvents()}return _createClass(t,[{key:"_navtransition_",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.swipe.firstElementChild.style.transition=t?"transform ".concat(this.duration,"ms ").concat(this.timingFn):""}},{key:"initStart",value:function(){var t=this;window.innerWidth<=this.screenWidth?(this.swipe.style.width="100%",this.swipe.style.position="fixed",this.swipe.style.height="100vh",this.swipe.style.transition="background .5s ease",this.swipe.style.background="rgba(0,0,0,0)",this.swipe.style.display="none",this.swipe.firstElementChild.style.width=this.width,this.swipe.addEventListener("click",(function(i){i.target===i.currentTarget&&t.close()})),this._navtransition_(),this.endTranslate=(this.right?1:-1)*document.body.offsetWidth,this.opened=!1,this.setTransform()):(this.swipe.style.position="",this.swipe.style.height="",this.swipe.style.transition="",this.swipe.style.width="",this.swipe.style.background="",this.swipe.style.display="",this.swipe.style.justifyContent="",this.swipe.firstElementChild.style.width="",this.swipe.removeEventListener("click",(function(i){i.target===i.currentTarget&&t.close()})),this._navtransition_(!1),this.swipe.firstElementChild.style.transform="")}},{key:"initEvents",value:function(){var t=this;this.swipe.firstElementChild.addEventListener("touchstart",(function(i){return t.startFn(i)})),this.swipe.firstElementChild.addEventListener("touchmove",(function(i){return t.moveFn(i)})),this.swipe.firstElementChild.addEventListener("touchend",(function(i){return t.endFn(i)})),window.addEventListener("resize",(function(){return t.initStart()}))}},{key:"startFn",value:function(t){window.innerWidth<=this.screenWidth&&(this.prevcx=t.touches[0].clientX,this.touchType="start")}},{key:"moveFn",value:function(t){if(window.innerWidth<=this.screenWidth){this._navtransition_(!1);var i=t.touches[0].clientX,e=this.endTranslate+i-this.prevcx;i>2&&(e<0&&!this.right||e>0&&this.right)&&(this.endTranslate=e,this.beforeEndTranslate=Math.abs(e),this.setTransform(),this.prevcx=i,this.touchType="move")}}},{key:"endFn",value:function(){window.innerWidth<=this.screenWidth&&"move"===this.touchType&&(this.beforeEndTranslate/this.swipe.offsetWidth*100>40?this.close():this.open(),this.touchType="end",this._navtransition_())}},{key:"setTransform",value:function(){if(window.innerWidth<=this.screenWidth){this.swipe.firstElementChild.style.transform="translate(".concat(this.endTranslate+"px",")");var t=this.opacity-this.beforeEndTranslate/this.swipe.firstElementChild.offsetWidth*this.opacity;this.swipe.style.background="rgba(0,0,0,".concat(t,")")}}},{key:"open",value:function(){var t=this;window.innerWidth<=this.screenWidth&&(this.swipe.style.display="flex",this.swipe.style.justifyContent=this.right?"flex-end":"",setTimeout((function(){t.endTranslate=0,t.opened=!0,t.setTransform(),t.swipe.style.background="rgba(0,0,0,".concat(t.opacity,")")}),1))}},{key:"close",value:function(){var t=this;if(window.innerWidth<=this.screenWidth){var i=(this.right?1:-1)*this.swipe.offsetWidth;this.endTranslate=i,this.opened=!1,this.setTransform(),this.swipe.style.background="rgba(0,0,0,0)",setTimeout((function(){return t.swipe.style.display="none"}),this.duration)}}},{key:"toggle",value:function(){this.opened?this.close():this.open()}},{key:"right",get:function(){return this.swipe.hasAttribute("right")&&!("false"===this.swipe.getAttribute("right")||!1===this.swipe.getAttribute("right"))},set:function(t){this.swipe.setAttribute("right",t),this.initStart()}},{key:"width",get:function(){var t=this.swipe.firstElementChild.getAttribute("width");return t?/^[0-9]+$/.test("".concat(t))?t+"%":t:"80%"}}]),t}();
