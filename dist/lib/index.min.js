"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}var SideBarSwipe=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=i.sideOpacity,n=void 0===s?.2:s,r=i.transitionDuration,h=void 0===r?300:r,a=i.maxScreenWidth,o=void 0===a?768:a,c=i.transitionTimingFunc,l=void 0===c?"ease":c;_classCallCheck(this,t),this.swipe=document.querySelector(e),this.swipe.style.display="none",this.duration=h,this.timingFn=l,this.screenWidth=o,this.endTranslate=0,this.beforeEndTranslate=0,this.opened=!0,this.prevcx=0,this.opacity=n,this.initStart(),this.initEvents()}return _createClass(t,[{key:"_navtransition_",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.swipe.firstElementChild.style.transition=t?"transform ".concat(this.duration,"ms ").concat(this.timingFn):""}},{key:"initStart",value:function(){var t=this;screen.availWidth<=this.screenWidth?(this.swipe.style.width="100%",this.swipe.style.position="fixed",this.swipe.style.height="100vh",this.swipe.style.transition="background .5s ease",this.swipe.style.background="rgba(0,0,0,0)",this.swipe.firstElementChild.style.width=this.width,this.swipe.addEventListener("click",(function(e){e.target===e.currentTarget&&t.close()})),this._navtransition_(),this.endTranslate=(this.right?1:-1)*document.body.offsetWidth,this.opened=!1,this.setTransform()):(this.swipe.style.position="",this.swipe.style.height="",this.swipe.style.transition="",this.swipe.style.width="",this.swipe.style.background="",this.swipe.firstElementChild.style.width="",this.swipe.removeEventListener("click",(function(e){e.target===e.currentTarget&&t.close()})),this._navtransition_(!1),this.swipe.firstElementChild.style.transform="")}},{key:"initEvents",value:function(){var t=this;this.swipe.addEventListener("touchstart",(function(e){return t.startFn(e)})),this.swipe.addEventListener("touchmove",(function(e){return t.moveFn(e)})),this.swipe.addEventListener("touchend",(function(e){return t.endFn(e)})),window.addEventListener("resize",(function(){return t.initStart()}))}},{key:"startFn",value:function(t){screen.availWidth<=this.screenWidth&&(this.prevcx=t.touches[0].clientX,this.touchType="start")}},{key:"moveFn",value:function(t){if(screen.availWidth<=this.screenWidth){this._navtransition_(!1);var e=t.touches[0].clientX,i=this.endTranslate+e-this.prevcx;e>2&&(i<0&&!this.right||i>0&&this.right)&&(this.endTranslate=i,this.beforeEndTranslate=Math.abs(i),this.setTransform(),this.prevcx=e,this.touchType="move")}}},{key:"endFn",value:function(){screen.availWidth<=this.screenWidth&&"move"===this.touchType&&(this.beforeEndTranslate/this.swipe.offsetWidth*100>40?this.close():this.open(),this.touchType="end",this._navtransition_())}},{key:"setTransform",value:function(){if(screen.availWidth<=this.screenWidth){this.swipe.firstElementChild.style.transform="translate(".concat(this.endTranslate+"px",")");var t=this.opacity-this.beforeEndTranslate/this.swipe.firstElementChild.offsetWidth*this.opacity;this.swipe.style.background="rgba(0,0,0,".concat(t,")")}}},{key:"open",value:function(){var t=this;screen.availWidth<=this.screenWidth&&(this.swipe.style.display="flex",this.swipe.style.justifyContent=this.right?"flex-end":"",setTimeout((function(){t.endTranslate=0,t.opened=!0,t.setTransform(),t.swipe.style.background="rgba(0,0,0,".concat(t.opacity,")")}),1))}},{key:"close",value:function(){var t=this;if(screen.availWidth<=this.screenWidth){var e=(this.right?1:-1)*this.swipe.offsetWidth;this.endTranslate=e,this.opened=!1,this.setTransform(),this.swipe.style.background="rgba(0,0,0,0)",setTimeout((function(){return t.swipe.style.display="none"}),this.duration)}}},{key:"toggle",value:function(){this.opened?this.close():this.open()}},{key:"right",get:function(){return this.swipe.hasAttribute("right")&&"false"!==this.swipe.getAttribute("right")},set:function(t){this.swipe.setAttribute("right",t),this.initStart()}},{key:"width",get:function(){var t=this.swipe.firstElementChild.getAttribute("width");return t?/^[0-9]+$/.test("".concat(t))?t+"%":t:"80%"}}]),t}();
