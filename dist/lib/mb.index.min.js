class SideBarSwipe{constructor(t,{sideOpacity:i=.2,transitionDuration:s=300,maxScreenWidth:e=768,transitionTimingFunc:h="ease"}={}){const n=Array.from(document.querySelectorAll("sidebar-swipe")).filter((i=>i.shadowRoot&&i.shadowRoot.querySelector(t)));console.log(n),this.swipe=n.length>0?n[0].shadowRoot.firstElementChild:document.querySelector(t),this.swipe.style.display="none",this.duration=s,this.timingFn=h,this.screenWidth=e,this.endTranslate=0,this.beforeEndTranslate=0,this.opened=!0,this.prevcx=0,this.opacity=i,this.initStart(),this.initEvents()}get right(){return this.swipe.hasAttribute("right")&&!("false"===this.swipe.getAttribute("right")||!1===this.swipe.getAttribute("right"))}set right(t){this.swipe.setAttribute("right",t),this.initStart()}get width(){const t=this.swipe.firstElementChild.getAttribute("width");return t?/^[0-9]+$/.test(""+t)?t+"%":t:"80%"}_navtransition_(t=!0){this.swipe.firstElementChild.style.transition=t?`transform ${this.duration}ms ${this.timingFn}`:""}initStart(){window.innerWidth<=this.screenWidth?(this.applied=!0,this.swipe.style.width="100%",this.swipe.style.position="fixed",this.swipe.style.height="100vh",this.swipe.style.transition="background .5s ease",this.swipe.style.background="rgba(0,0,0,0)",this.swipe.style.display="none",this.swipe.firstElementChild.style.width=this.width,this.swipe.addEventListener("click",(t=>{t.target===t.currentTarget&&this.close()})),this._navtransition_(),this.endTranslate=(this.right?1:-1)*document.body.offsetWidth,this.opened=!1,this.setTransform()):(this.applied=!1,this.swipe.style.position="",this.swipe.style.height="",this.swipe.style.transition="",this.swipe.style.width="",this.swipe.style.background="",this.swipe.style.display="",this.swipe.style.justifyContent="",this.swipe.firstElementChild.style.width="",this.swipe.removeEventListener("click",(t=>{t.target===t.currentTarget&&this.close()})),this._navtransition_(!1),this.swipe.firstElementChild.style.transform="")}initEvents(){this.swipe.firstElementChild.addEventListener("touchstart",(t=>this.startFn(t))),this.swipe.firstElementChild.addEventListener("touchmove",(t=>this.moveFn(t))),this.swipe.firstElementChild.addEventListener("touchend",(t=>this.endFn(t))),window.addEventListener("resize",(()=>this.initStart()))}startFn(t){this.applied&&(this.prevcx=t.touches[0].clientX,this.touchType="start")}moveFn(t){if(this.applied){this._navtransition_(!1);let i=t.touches[0].clientX,s=this.endTranslate+i-this.prevcx;i>2&&(s<0&&!this.right||s>0&&this.right)&&(this.endTranslate=s,this.beforeEndTranslate=Math.abs(s),this.setTransform(),this.prevcx=i,this.touchType="move")}}endFn(){this.applied&&"move"===this.touchType&&(this.beforeEndTranslate/this.swipe.offsetWidth*100>40?this.close():this.open(),this.touchType="end",this._navtransition_())}setTransform(){if(this.applied){this.swipe.firstElementChild.style.transform=`translate(${this.endTranslate+"px"})`;const t=this.opacity-this.beforeEndTranslate/this.swipe.firstElementChild.offsetWidth*this.opacity;this.swipe.style.background=`rgba(0,0,0,${t})`}}open(){this.applied&&(this.swipe.style.display="flex",this.swipe.style.justifyContent=this.right?"flex-end":"",setTimeout((()=>{this.endTranslate=0,this.opened=!0,this.setTransform(),this.swipe.style.background=`rgba(0,0,0,${this.opacity})`}),1))}close(){if(this.applied){const t=(this.right?1:-1)*this.swipe.offsetWidth;this.endTranslate=t,this.opened=!1,this.setTransform(),this.swipe.style.background="rgba(0,0,0,0)",setTimeout((()=>this.swipe.style.display="none"),this.duration)}}toggle(){this.opened?this.close():this.open()}}
